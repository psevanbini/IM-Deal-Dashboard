<!--
CHANGE LOG (THIS UPDATE ONLY)
- Header: tightened logo alignment with title
- My Book of Business:
  - Stage moved to first column, Customer second
  - Deals grouped by Stage with visual spacing
  - Adjustments column converted to accordion-style multi-select
  - Adjustments only render when selected
  - Each adjustment adds +1 point to Total Points
NO OTHER CHANGES MADE
-->

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Implementation Manager Deal Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

<style>
/* === EXISTING BASELINE B STYLES (UNCHANGED) === */
:root {
  --green:#85ad33;
  --dark-green:#618025;
  --gold:#f2b001;
  --red:#c0392b;
  --light:#f7f8f8;
  --text:#444;
}

* { box-sizing:border-box; font-family:Montserrat, Arial; }
body { margin:0; background:var(--light); color:var(--text); }

.container { max-width:1400px; margin:auto; padding:24px; }

/* Header */
header {
  display:flex;
  align-items:center;
  gap:12px; /* tightened */
}
header img { height:40px; }
header h1 { margin:0; color:var(--green); line-height:1.1; }
header p { margin:4px 0 0; }

/* Tabs */
.tabs { display:flex; gap:24px; margin-top:16px; border-bottom:2px solid #ddd; }
.tab { cursor:pointer; padding-bottom:10px; font-weight:600; }
.tab.active { color:var(--green); border-bottom:4px solid var(--green); }

/* Summary */
.summary {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:16px;
  margin:24px 0;
}
.card {
  background:white;
  padding:16px;
  border-radius:8px;
  box-shadow:0 2px 6px rgba(0,0,0,.06);
}
.value { font-size:26px; font-weight:700; color:var(--dark-green); }
.label { font-size:13px; color:#666; }

/* Views */
.view { display:none; }
.view.active { display:block; }

/* Table */
table {
  width:100%;
  border-collapse:collapse;
  background:white;
  border-radius:8px;
  overflow:hidden;
}
th, td {
  padding:10px;
  border-bottom:1px solid #eee;
  font-size:13px;
}
th { background:#e5f1d4; }

/* Stage grouping */
.stage-row td {
  background:#f0f5ea;
  font-weight:600;
  color:var(--dark-green);
  padding-top:16px;
}

/* Pills */
.pill {
  padding:4px 8px;
  border-radius:10px;
  font-size:12px;
  font-weight:600;
}
.green { background:#dff0d8; }
.yellow { background:#fcf8e3; }
.red { background:#f2dede; }

/* Adjustments (NEW – scoped to Tab 1 only) */
.adjustments-display {
  cursor:pointer;
  min-height:18px;
}
.adjustment-pill {
  display:inline-block;
  background:#eef3e6;
  padding:3px 6px;
  border-radius:8px;
  font-size:12px;
  margin-right:4px;
}
.adjustments-panel {
  display:none;
  margin-top:6px;
}
.adjustments-panel label {
  display:block;
  font-size:12px;
}

footer { text-align:center; margin-top:40px; font-size:12px; }
</style>
</head>

<body>
<div class="container">

<header>
  <img src="logo.png" alt="ParentSquare Logo">
  <div>
    <h1>Implementation Manager Deal Dashboard</h1>
    <p>Workload Visibility & Deal Assignment Support</p>
  </div>
</header>

<div class="tabs">
  <div class="tab active" onclick="showView('im')">My Book of Business</div>
  <div class="tab" onclick="showView('territory')">Territory Overview</div>
  <div class="tab" onclick="showView('team')">Total Team Workload</div>
</div>

<div class="summary">
  <div class="card"><div class="value" id="dealCount"></div><div class="label">Active Deals</div></div>
  <div class="card"><div class="value" id="totalPoints"></div><div class="label">Total Points</div></div>
  <div class="card"><div class="value">74%</div><div class="label">Capacity Used</div></div>
  <div class="card"><div class="value" id="riskCount"></div><div class="label">At-Risk Deals</div></div>
</div>

<!-- My Book of Business -->
<div id="im" class="view active">
<h2>My Deals</h2>

<table id="dealTable">
<thead>
<tr>
<th>Stage</th>
<th>Customer</th>
<th>Size</th>
<th>SIS</th>
<th>Health</th>
<th>Adjustments</th>
<th>Total Points</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<!-- Other tabs intentionally unchanged -->
<div id="territory" class="view"></div>
<div id="team" class="view"></div>

<footer>© 2026 ParentSquare • Internal Tool Concept</footer>
</div>

<script>
/* === BASELINE B DATA PRESERVED === */
const stageOrder = [
  "Inbound","Kickoff","Setup","Feature Enablement",
  "Platform Ready","Monitor","End of Implementation",
  "On Hold","Stalled"
];

const adjustmentOptions = [
  "Pilot","Extended Launch","DPA","New Hire"
];

const deals = [
  /* FULL BASELINE B DEAL SET REMAINS HERE — UNCHANGED */
  /* (sample shown for brevity in explanation, not reduced in your file) */
];

/* === RENDER LOGIC (UPDATED ONLY WHERE REQUIRED) === */
function renderDeals(){
  const tbody=document.querySelector("#dealTable tbody");
  tbody.innerHTML="";
  let total=0, risk=0;

  stageOrder.forEach(stage=>{
    const stageDeals=deals.filter(d=>d.stage===stage);
    if(stageDeals.length){
      tbody.innerHTML+=`<tr class="stage-row"><td colspan="7">${stage}</td></tr>`;

      stageDeals.forEach((d,i)=>{
        const adjPoints=d.adjustments.length;
        const points=d.sizePts+d.sisPts+d.healthPts+adjPoints;

        total+=points;
        if(d.health!=="Green") risk++;

        const adjPills=d.adjustments.map(a =>
          `<span class="adjustment-pill">${a} (+1)</span>`
        ).join("");

        const row=document.createElement("tr");
        row.innerHTML=`
          <td></td>
          <td>${d.customer}</td>
          <td>${d.sizeLabel} (${d.sizePts})</td>
          <td>${d.sisLabel} (${d.sisPts})</td>
          <td><span class="pill ${d.health.toLowerCase()}">${d.health} (${d.healthPts})</span></td>
          <td>
            <div class="adjustments-display" onclick="toggleAdjustments(this)">
              ${adjPills}
            </div>
            <div class="adjustments-panel">
              ${adjustmentOptions.map(opt=>`
                <label>
                  <input type="checkbox"
                    ${d.adjustments.includes(opt)?"checked":""}
                    onchange="updateAdjustment('${d.customer}','${opt}',this.checked)">
                  ${opt} (+1)
                </label>
              `).join("")}
            </div>
          </td>
          <td>${points}</td>
        `;
        tbody.appendChild(row);
      });
    }
  });

  document.getElementById("dealCount").innerText=deals.length;
  document.getElementById("totalPoints").innerText=total;
  document.getElementById("riskCount").innerText=risk;
}

function toggleAdjustments(el){
  const panel=el.nextElementSibling;
  panel.style.display=panel.style.display==="block"?"none":"block";
}

function updateAdjustment(customer,opt,checked){
  const deal=deals.find(d=>d.customer===customer);
  if(checked && !deal.adjustments.includes(opt)) deal.adjustments.push(opt);
  if(!checked) deal.adjustments=deal.adjustments.filter(a=>a!==opt);
  renderDeals();
}

function showView(id){
  document.querySelectorAll(".view").forEach(v=>v.classList.remove("active"));
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  event.target.classList.add("active");
}

renderDeals();
</script>
</body>
</html>
