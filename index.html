<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Implementation Manager Deal Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --ps-green: #85ad33;
      --ps-dark-green: #618025;
      --ps-blue: #7bbaf0;
      --ps-gold: #f2b001;
      --ps-light-green: #e5f1d4;
      --ps-light-gray: #f7f8f8;
      --ps-dark-gray: #444444;
      --ps-red: #d9534f;
    }

    * { box-sizing: border-box; font-family: "Montserrat", sans-serif; }
    body { margin: 0; background: var(--ps-light-gray); color: var(--ps-dark-gray); }
    .container { max-width: 1200px; margin: 0 auto; padding: 24px; }
    
    header { margin-bottom: 24px; }
    header h1 { color: var(--ps-green); margin: 0; font-size: 28px; }

    .tabs { display: flex; gap: 24px; border-bottom: 2px solid #ddd; margin-bottom: 24px; }
    .tab { padding-bottom: 12px; cursor: pointer; font-weight: 600; color: #666; transition: 0.3s; }
    .tab.active { color: var(--ps-green); border-bottom: 4px solid var(--ps-green); }

    .summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 32px; }
    .card { background: white; padding: 16px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
    .card .value { font-size: 26px; font-weight: 700; color: var(--ps-dark-green); }
    .card .label { font-size: 14px; color: #666; }

    .view { display: none; }
    .view.active { display: block; }

    table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; margin-top: 10px; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; font-size: 14px; }
    th { background: var(--ps-light-green); font-weight: 600; }

    .pill { padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: 700; text-transform: uppercase; }
    .green { background: #dff0d8; color: #3c763d; }
    .yellow { background: #fcf8e3; color: #8a6d3b; }
    .red { background: #f2dede; color: #a94442; }

    .im-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px; }
    .progress-container { margin-top: 15px; }
    .progress { height: 10px; background: #eee; border-radius: 5px; overflow: hidden; }
    .progress-bar { height: 100%; transition: width 0.5s ease; }
    
    .tier-badge { font-size: 10px; background: #eee; padding: 2px 6px; border-radius: 4px; vertical-align: middle; }
  </style>
</head>
<body>

  <div class="container">
    <header>
      <h1>Implementation Manager Dashboard</h1>
      <p>Live Book of Business & Capacity Tracking</p>
    </header>

    <div class="tabs">
      <div class="tab active" onclick="showView(event, 'im-view')">My Book of Business</div>
      <div class="tab" onclick="showView(event, 'territory-view')">Territory Overview</div>
    </div>

    <div id="summary-counters" class="summary">
      <div class="card"><div id="total-deals" class="value">0</div><div class="label">Active Deals</div></div>
      <div class="card"><div id="total-points" class="value">0</div><div class="label">Total Points</div></div>
      <div class="card"><div id="avg-capacity" class="value">0%</div><div class="label">Avg. Team Capacity</div></div>
    </div>

    <div id="im-view" class="view active">
      <h2>My Current Deals</h2>
      <table id="deals-table">
        <thead>
          <tr>
            <th>Customer</th>
            <th>Size</th>
            <th>SIS</th>
            <th>Health</th>
            <th>Points</th>
          </tr>
        </thead>
        <tbody id="deals-body">
          </tbody>
      </table>
    </div>

    <div id="territory-view" class="view">
      <h2>Team Workload</h2>
      <div class="im-grid" id="im-grid">
        </div>
    </div>

    <footer>© 2026 ParentSquare • Implementation Team</footer>
  </div>

  <script>
    // 1. Data Structure
    const teamData = {
      ims: [
        { name: "Alex R.", tier: 3, maxPoints: 50, deals: [
          { name: "District A", size: "Medium", sis: "PowerSchool", health: "yellow", points: 6 },
          { name: "Charter B", size: "Large", sis: "Infinite Campus", health: "red", points: 8 }
        ]},
        { name: "Jordan M.", tier: 2, maxPoints: 40, deals: [
          { name: "Crestview USD", size: "Large", sis: "Aeries", health: "green", points: 10 },
          { name: "Oak Academy", size: "Small", sis: "Skyward", health: "green", points: 4 }
        ]}
      ]
    };

    // 2. Tab Logic
    function showView(event, viewId) {
      document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.getElementById(viewId).classList.add('active');
      event.currentTarget.classList.add('active');
    }

    // 3. Render Dashboard
    function renderDashboard() {
      const dealsBody = document.getElementById('deals-body');
      const imGrid = document.getElementById('im-grid');
      let grandTotalPoints = 0;
      let totalDeals = 0;
      let capacitySum = 0;

      dealsBody.innerHTML = '';
      imGrid.innerHTML = '';

      teamData.ims.forEach(im => {
        let imPoints = 0;
        
        // Process Deals for "My View" (Using Alex R as 'Current User' for example)
        im.deals.forEach(deal => {
          imPoints += deal.points;
          totalDeals++;
          
          if(im.name === "Alex R.") {
            dealsBody.innerHTML += `
              <tr>
                <td>${deal.name}</td>
                <td>${deal.size}</td>
                <td>${deal.sis}</td>
                <td><span class="pill ${deal.health}">${deal.health}</span></td>
                <td>${deal.points}</td>
              </tr>`;
          }
        });

        // Process IM Cards for "Territory View"
        const capPct = Math.round((imPoints / im.maxPoints) * 100);
        capacitySum += capPct;
        grandTotalPoints += imPoints;

        const barColor = capPct > 90 ? 'var(--ps-red)' : (capPct > 70 ? 'var(--ps-gold)' : 'var(--ps-green)');

        imGrid.innerHTML += `
          <div class="card">
            <strong>${im.name}</strong> <span class="tier-badge">Tier ${im.tier}</span>
            <div class="label">Points: ${imPoints} / ${im.maxPoints}</div>
            <div class="progress-container">
              <div class="progress">
                <div class="progress-bar" style="width: ${capPct}%; background: ${barColor};"></div>
              </div>
              <div class="label" style="text-align:right; font-size:10px; margin-top:4px;">${capPct}% Capacity</div>
            </div>
          </div>`;
      });

      // Update Header Summary
      document.getElementById('total-deals').innerText = totalDeals;
      document.getElementById('total-points').innerText = grandTotalPoints;
      document.getElementById('avg-capacity').innerText = Math.round(capacitySum / teamData.ims.length) + '%';
    }

    // Initialize
    renderDashboard();
  </script>
</body>
</html>
